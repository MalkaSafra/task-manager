<h2 mat-dialog-title>
  <mat-icon>comment</mat-icon>
  Comments - {{ taskTitle }}
</h2>

<mat-dialog-content>
  <!-- Add Comment Section -->
  <div class="add-comment-section">
    <mat-form-field appearance="outline" class="comment-input">
      <mat-label>Add a comment</mat-label>
      <textarea 
        matInput 
        [(ngModel)]="newComment" 
        placeholder="Write your comment here..."
        rows="2"
      ></textarea>
    </mat-form-field>
    <button 
      mat-raised-button 
      color="primary" 
      (click)="onAddComment()"
      [disabled]="!newComment.trim()"
    >
      <mat-icon>send</mat-icon>
      Send
    </button>
  </div>

  <mat-divider></mat-divider>

  <!-- Comments List -->
  <div class="comments-list">
    @if (isLoading) {
      <div class="loading">
        <mat-spinner diameter="40"></mat-spinner>
        <span>Loading comments...</span>
      </div>
    } @else if (comments.length === 0) {
      <div class="no-comments">
        <mat-icon>chat_bubble_outline</mat-icon>
        <p>No comments yet</p>
        <span>Be the first to comment!</span>
      </div>
    } @else {
      @for (comment of comments; track comment.id) {
        <div class="comment-item">
          <div class="comment-header">
            <div class="user-info">
              <mat-icon>account_circle</mat-icon>
              <span class="user-name">{{ comment.authorName || 'User' }}</span>
            </div>
            <span class="comment-date">{{ formatDate(comment.createdAt) }}</span>
          </div>
          <p class="comment-content">{{ comment.body }}</p>
        </div>
      }
    }
  </div>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button (click)="onClose()">Close</button>
</mat-dialog-actions>
