<div class="dashboard-container">
  <!-- Welcome Section -->
  <div class="welcome-section">
    <h1>{{ getGreeting() }}, {{ userName }}! ðŸ‘‹</h1>
    <p class="subtitle">Here's what's happening with your tasks today</p>
  </div>

  <!-- Error Alert -->
  @if (hasError()) {
    <app-error-alert 
      [message]="getErrorMessage()"
      (onRetry)="loadData()"
    />
  }

  <!-- Loading State -->
  @if (isLoading()) {
    <app-loading-spinner message="Loading dashboard data..." />
  } @else {
    <!-- Statistics Cards -->
    <div class="stats-grid">
      <mat-card class="stat-card teams" (click)="navigateTo('/teams')">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>groups</mat-icon>
          </div>
          <div class="stat-info">
            <span class="stat-value">{{ totalTeams() }}</span>
            <span class="stat-label">Teams</span>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="stat-card projects" (click)="navigateTo('/projects')">
        <mat-card-content>
          <div class="stat-icon">
            <mat-icon>folder</mat-icon>
          </div>
          <div class="stat-info">
            <span class="stat-value">{{ totalProjects() }}</span>
            <span class="stat-label">Projects</span>
          </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card tasks" (click)="navigateTo('/tasks')">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>checklist</mat-icon>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ totalTasks() }}</span>
          <span class="stat-label">Total Tasks</span>
        </div>
      </mat-card-content>
    </mat-card>

    <mat-card class="stat-card completed">
      <mat-card-content>
        <div class="stat-icon">
          <mat-icon>check_circle</mat-icon>
        </div>
        <div class="stat-info">
          <span class="stat-value">{{ progressPercentage() }}%</span>
          <span class="stat-label">Completed</span>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Progress Overview -->
  <mat-card class="progress-card">
    <mat-card-header>
      <mat-card-title>Task Progress Overview</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="progress-stats">
        <div class="progress-stat todo">
          <mat-icon>radio_button_unchecked</mat-icon>
          <span class="count">{{ todoCount() }}</span>
          <span class="label">To Do</span>
        </div>
        <div class="progress-stat in-progress">
          <mat-icon>pending</mat-icon>
          <span class="count">{{ inProgressCount() }}</span>
          <span class="label">In Progress</span>
        </div>
        <div class="progress-stat completed">
          <mat-icon>check_circle</mat-icon>
          <span class="count">{{ completedCount() }}</span>
          <span class="label">Completed</span>
        </div>
      </div>
      <mat-progress-bar mode="determinate" [value]="progressPercentage()"></mat-progress-bar>
    </mat-card-content>
  </mat-card>

  <!-- Main Content Grid -->
  <div class="content-grid">
    <!-- Due Today -->
    <mat-card class="content-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="header-icon today">today</mat-icon>
        <mat-card-title>Due Today</mat-card-title>
        <mat-card-subtitle>{{ tasksDueToday().length }} tasks</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (tasksDueToday().length === 0) {
          <div class="empty-state">
            <mat-icon>event_available</mat-icon>
            <p>No tasks due today!</p>
          </div>
        } @else {
          <div class="task-list">
            @for (task of tasksDueToday(); track task.id) {
              <div class="task-item">
                <mat-icon [style.color]="getStatusColor(task.status)">
                  {{ getStatusIcon(task.status) }}
                </mat-icon>
                <span class="task-title">{{ task.title }}</span>
                <mat-chip [color]="getPriorityColor(task.priority)" size="small">
                  {{ task.priority }}
                </mat-chip>
              </div>
            }
          </div>
        }
      </mat-card-content>
      <mat-card-actions>
        <button mat-button color="primary" (click)="navigateTo('/tasks')">
          View All Tasks
        </button>
      </mat-card-actions>
    </mat-card>

    <!-- High Priority -->
    <mat-card class="content-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="header-icon priority">priority_high</mat-icon>
        <mat-card-title>High Priority</mat-card-title>
        <mat-card-subtitle>{{ highPriorityTasks().length }} urgent tasks</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (highPriorityTasks().length === 0) {
          <div class="empty-state">
            <mat-icon>thumb_up</mat-icon>
            <p>No urgent tasks!</p>
          </div>
        } @else {
          <div class="task-list">
            @for (task of highPriorityTasks(); track task.id) {
              <div class="task-item">
                <mat-icon [style.color]="getStatusColor(task.status)">
                  {{ getStatusIcon(task.status) }}
                </mat-icon>
                <span class="task-title">{{ task.title }}</span>
                @if (task.dueDate) {
                  <span class="due-date">{{ formatDate(task.dueDate) }}</span>
                }
              </div>
            }
          </div>
        }
      </mat-card-content>
    </mat-card>

    <!-- Overdue Tasks -->
    <mat-card class="content-card overdue-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="header-icon overdue">warning</mat-icon>
        <mat-card-title>Overdue</mat-card-title>
        <mat-card-subtitle>{{ overdueTasks().length }} overdue tasks</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (overdueTasks().length === 0) {
          <div class="empty-state success">
            <mat-icon>celebration</mat-icon>
            <p>You're all caught up!</p>
          </div>
        } @else {
          <div class="task-list">
            @for (task of overdueTasks(); track task.id) {
              <div class="task-item overdue">
                <mat-icon color="warn">error</mat-icon>
                <span class="task-title">{{ task.title }}</span>
                <span class="due-date overdue">{{ formatDate(task.dueDate) }}</span>
              </div>
            }
          </div>
        }
      </mat-card-content>
    </mat-card>

    <!-- Recent Tasks -->
    <mat-card class="content-card">
      <mat-card-header>
        <mat-icon mat-card-avatar class="header-icon recent">history</mat-icon>
        <mat-card-title>Recent Tasks</mat-card-title>
        <mat-card-subtitle>Latest activity</mat-card-subtitle>
      </mat-card-header>
      <mat-card-content>
        @if (recentTasks().length === 0) {
          <div class="empty-state">
            <mat-icon>add_task</mat-icon>
            <p>No tasks yet. Create one!</p>
          </div>
        } @else {
          <div class="task-list">
            @for (task of recentTasks(); track task.id) {
              <div class="task-item">
                <mat-icon [style.color]="getStatusColor(task.status)">
                  {{ getStatusIcon(task.status) }}
                </mat-icon>
                <span class="task-title">{{ task.title }}</span>
                <mat-chip [color]="getPriorityColor(task.priority)" size="small">
                  {{ task.priority }}
                </mat-chip>
              </div>
            }
          </div>
        }
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Quick Actions -->
  <div class="quick-actions">
    <button mat-fab extended color="primary" (click)="navigateTo('/tasks')">
      <mat-icon>add</mat-icon>
      New Task
    </button>
    <button mat-fab extended (click)="navigateTo('/projects')">
      <mat-icon>create_new_folder</mat-icon>
      New Project
    </button>
    <button mat-fab extended (click)="navigateTo('/teams')">
      <mat-icon>group_add</mat-icon>
      New Team
    </button>
  </div>
  }
</div>